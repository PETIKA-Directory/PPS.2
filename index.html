<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Controle de Ciclos de Produção</title>
    <style>
        :root {
            --primary-color: #4caf50;
            --secondary-color: #1b1b1b;
            --text-color: #ffffff;
            --accent-color: #ff9800;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
            gap: 20px;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%;
            max-width: 600px;
            padding: 20px;
            background: #333;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .cronometro {
            font-size: 48px;
            margin: 10px 0;
            color: var(--accent-color);
        }

        .etapa {
            font-size: 24px;
            margin: 10px 0;
        }

        .btn-estampar {
            margin: 20px 0;
            padding: 10px 20px;
            font-size: 18px;
            color: var(--text-color);
            background: var(--primary-color);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-estampar:hover {
            background: var(--accent-color);
        }

        .indicadores {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin: 20px 0;
        }

        .indicador {
            flex: 1;
            text-align: center;
            padding: 10px;
            margin: 0 5px;
            background: #444;
            border-radius: 5px;
        }

        .historico {
            width: 100%;
            margin-top: 20px;
        }

        .historico table {
            width: 100%;
            border-collapse: collapse;
        }

        .historico th, .historico td {
            padding: 10px;
            text-align: left;
            border: 1px solid #555;
        }

        @media (max-width: 768px) {
            .container {
                width: 100%;
                padding: 10px;
            }

            .cronometro {
                font-size: 36px;
            }

            .btn-estampar {
                font-size: 16px;
                padding: 8px 16px;
            }

            .indicadores {
                flex-direction: column;
                gap: 10px;
            }

            .indicador {
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="cronometro" id="cronometro">20</div>
        <div class="etapa" id="etapa">Pegar a Peça</div>
        <button class="btn-estampar" id="btn-estampar">Estampar</button>
        <div class="indicadores">
            <div class="indicador">Ciclos: <span id="ciclos">0</span></div>
            <div class="indicador">Peças: <span id="pecas">0</span></div>
            <div class="indicador">Eficiência: <span id="eficiencia">0%</span></div>
        </div>
        <div class="historico">
            <table>
                <thead>
                    <tr>
                        <th>Início</th>
                        <th>Fim</th>
                        <th>Tempo Restante</th>
                    </tr>
                </thead>
                <tbody id="historico"></tbody>
            </table>
        </div>
    </div>

    <script>
        const cronometro = document.getElementById('cronometro');
        const etapa = document.getElementById('etapa');
        const btnEstampar = document.getElementById('btn-estampar');
        const ciclos = document.getElementById('ciclos');
        const pecas = document.getElementById('pecas');
        const eficiencia = document.getElementById('eficiencia');
        const historico = document.getElementById('historico');

        let tempoTotal = 20;
        let tempoAtual = tempoTotal;
        let etapaAtual = 0;
        let totalCiclos = 0;
        let totalPecas = 0;
        let cicloEmAndamento = false;

        const etapas = [
            { nome: 'Pegar a Peça', tempo: 5 },
            { nome: 'Posicionar', tempo: 5 },
            { nome: 'Estampar', tempo: 5 },
            { nome: 'Retirar', tempo: 5 }
        ];

        function atualizarCronometro() {
            if (tempoAtual > 0) {
                tempoAtual--;
                cronometro.textContent = tempoAtual;

                const tempoEtapa = etapas[etapaAtual].tempo;
                if (tempoAtual <= tempoTotal - tempoEtapa * etapaAtual) {
                    etapaAtual++;
                    if (etapaAtual < etapas.length) {
                        etapa.textContent = etapas[etapaAtual].nome;
                    }
                }
            } else {
                registrarCiclo();
                reiniciarCiclo();
            }
        }

        function registrarCiclo() {
            totalCiclos++;
            totalPecas += 2;

            const inicio = new Date();
            const fim = new Date();

            historico.innerHTML += `<tr><td>${inicio.toLocaleTimeString()}</td><td>${fim.toLocaleTimeString()}</td><td>${tempoAtual}</td></tr>`;

            ciclos.textContent = totalCiclos;
            pecas.textContent = totalPecas;

            const eficienciaCalc = (totalCiclos * 2 / (3600 / tempoTotal)) * 100;
            eficiencia.textContent = `${eficienciaCalc.toFixed(2)}%`;
        }

        function reiniciarCiclo() {
            tempoAtual = tempoTotal;
            etapaAtual = 0;
            etapa.textContent = etapas[etapaAtual].nome;
            cronometro.textContent = tempoAtual;
            cicloEmAndamento = false;
        }

        let interval;
        btnEstampar.addEventListener('click', () => {
            if (!cicloEmAndamento) {
                cicloEmAndamento = true;
                const inicio = new Date();
                historico.innerHTML += `<tr><td>${inicio.toLocaleTimeString()}</td><td>-</td><td>-</td></tr>`;
                interval = setInterval(atualizarCronometro, 1000);
            }

            // Incrementa ciclos e peças imediatamente no clique do botão
            totalCiclos++;
            totalPecas += 2;
            ciclos.textContent = totalCiclos;
            pecas.textContent = totalPecas;

            // Atualiza eficiência
            const eficienciaCalc = (totalCiclos * 2 / (3600 / tempoTotal)) * 100;
            eficiencia.textContent = `${eficienciaCalc.toFixed(2)}%`;
        });
    </script>
</body>
</html>
